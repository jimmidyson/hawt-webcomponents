<link rel="import" href="../../bower_components/paper-menu-button/paper-menu-button.html"/>
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html"/>
<link rel="import" href="../../bower_components/paper-dropdown/paper-dropdown.html"/>
<link rel="import" href="../../bower_components/paper-item/paper-item.html"/>

<polymer-element name="icon-change-menu-button" attributes="selected items">
  <template>
    <paper-menu-button>
      <paper-icon-button icon="{{selected.icon}}" src="{{selected.image}}" noink></paper-icon-button>
      <paper-dropdown class="dropdown" layered>
        <core-menu class="menu" valueattr="id" selected="{{selectedItem}}" selectedModel={{selectedModel}}>
          <template repeat="{{item in items}}">
            <paper-item noink id="{{item.id}}"><core-icon icon="{{item.icon}}" src="{{item.image}}" alt="{{item.label}}"></core-icon>{{item.label}}</paper-item>
          </template>
        </core-menu>
      </paper-dropdown>
    </paper-menu-button>
  </template>
  <script>
    Polymer({
      ready: function () {
        this.items = this.items || [];
        this.selected = this.selected || this.items[0];
        this.selectedItem = this.selectedItem || this.selected.id;
      },
      selectedModelChanged: function(oldValue, newValue) {
        if (newValue) {
          var item = newValue.item;
          console.log(item);
          this.selected = item;
        }
      }
    });
  </script>
</polymer-element>
